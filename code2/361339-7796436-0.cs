    // prepare the dictionary
    Dictionary<Key, List<double>> dic = new Dictionary<Key, List<double>>();
    for (int i =0; i< XYPair.Count; i++){
      // create the key
      // put ZValue[i] values in dictionary list element 
    } 
    
    // use the Dictionary:
    
      // loop around dic keys
      // if matched apply statistics
