    // Prepare the dictionary
    Dictionary<Key, List<double>> dic = new Dictionary<Key, List<double>>();
    for (int i =0; i< XYPair.Count; i++){
        // Create the key
        // Put ZValue[i] values in dictionary list element
    }
    // Use the Dictionary:
    // Loop around dic keys
    // If matched, apply statistics
