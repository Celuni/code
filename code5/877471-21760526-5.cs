    private void Control_VisibleChanged(object sender, 
                                            DependencyPropertyChangedEventArgs e)
    {
        if ((bool)e.NewValue)
        {
           // Visible code here
        }
        else
        { 
           // Collapse code here
        }
     }
