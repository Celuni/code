    public partial class MainWindow : Window
    {
        public List<D> Data { get; set; }
        public MainWindow()
        {
            Data = new List<D>();
            Random r = new Random();
            Data.Add(new D(r.NextDouble()));
            Data.Add(new D(r.NextDouble()));
            Data.Add(new D(r.NextDouble()));
            InitializeComponent();
            DataContext = this;
        }
        private void DataGrid_AutoGeneratedColumns(object sender, EventArgs e)
        {
            foreach (DataGridTextColumn c in dg.Columns)
            {
                c.EditingElementStyle = (Style)dg.FindResource("s");
            }
        }
        private void OnBeginningEdit(object sender, DataGridPreparingCellForEditEventArgs e)
        {
            TextBox tbx = (TextBox)e.EditingElement;
            Binding binding = BindingOperations.GetBinding(tbx, TextBox.TextProperty);
            binding.ValidationRules.Clear();
            binding.ValidationRules.Add(new VR());
        }
    }
