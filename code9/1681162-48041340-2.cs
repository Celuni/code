    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;
    using System.Xml;
    using System.Xml.Serialization;
    using System.IO;
    namespace ConsoleApplication1
    {
        class Program
        {
            const string FILENAME = @"c:\temp\test.xml";
            static void Main(string[] args)
            {
                string operation = "Purchase";
                DateTime now = DateTime.Now;
                string token = "12345";
                string name = "John Smith";
                string bank = "BOA";
                string message = "Paid in Full";
                XmlSerializerNamespaces namespaces = new XmlSerializerNamespaces();
                namespaces.Add("soapenv", "http://schemas.xmlsoap.org/soap/envelope/");
                namespaces.Add("cre", "http://creation.soapws.progressoft.com/");
                Envelope envelope = new Envelope()
                {
                    Header = new EnvelopeHeader[] {
                        new EnvelopeHeader() { paymentOperation = operation, requestTimeStamp = now, securityToken = token, username = name}
                    },
                    Body = new EnvelopeBody[] {
                        new EnvelopeBody() {
                            item = new paymentItem() {
                                payment = new PaymentRequest[] {
                                    new PaymentRequest() {
                                         beneficiaryBranchName = bank,
                                         transactionDate = now,
                                    }
                                }
                            }
                        }
                    }
                };
                XmlSerializer serializer = new XmlSerializer(typeof(Envelope), "soapenv:http://schemas.xmlsoap.org/soap/envelope/");
                XmlWriterSettings settings = new XmlWriterSettings();
                settings.Indent = true;
                settings.NamespaceHandling = NamespaceHandling.OmitDuplicates;
                settings.OmitXmlDeclaration = true;
                XmlWriter writer = XmlWriter.Create(FILENAME, settings);
                serializer.Serialize(writer, envelope, namespaces);
                writer.Flush();
                writer.Close();
                //writer.Dispose();
            }
        }
        //------------------------------------------------------------------------------
        // <auto-generated>
        //     This code was generated by a tool.
        //     Runtime Version:2.0.50727.6421
        //
        //     Changes to this file may cause incorrect behavior and will be lost if
        //     the code is regenerated.
        // </auto-generated>
        //------------------------------------------------------------------------------
        //using System.Xml.Serialization;
        // 
        // This source code was auto-generated by xsd, Version=2.0.50727.3038.
        // 
        /// <remarks/>
        [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
        [System.SerializableAttribute()]
        [System.Diagnostics.DebuggerStepThroughAttribute()]
        [System.ComponentModel.DesignerCategoryAttribute("code")]
        [System.Xml.Serialization.XmlTypeAttribute(Namespace="http://opay.progressoft.com/PaymentCreationSchema")]
        [System.Xml.Serialization.XmlRootAttribute("file", Namespace="http://opay.progressoft.com/PaymentCreationSchema", IsNullable=false)]
        public partial class paymentItem {
        
            private PaymentRequest[] paymentField;
        
            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute("payment")]
            public PaymentRequest[] payment {
                get {
                    return this.paymentField;
                }
                set {
                    this.paymentField = value;
                }
            }
        }
        /// <remarks/>
        [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
        [System.SerializableAttribute()]
        [System.Diagnostics.DebuggerStepThroughAttribute()]
        [System.ComponentModel.DesignerCategoryAttribute("code")]
        [System.Xml.Serialization.XmlTypeAttribute(Namespace="http://opay.progressoft.com/PaymentCreationSchema")]
        public partial class PaymentRequest {
        
            private string recordTypeField;
        
            private string transactionReferenceField;
        
            private System.DateTime transactionDateField;
        
            private string senderCurrencyField;
        
            private string beneficiaryCurrencyField;
        
            private decimal transferAmountField;
        
            private string remitterFirstNameField;
        
            private string remitterMiddleNameField;
        
            private string remitterLastName1Field;
        
            private string remitterLastName2Field;
        
            private string remitterNationalityField;
        
            private string remitterMobileNoField;
        
            private string remitterAddress1Field;
        
            private string remitterAddress2Field;
        
            private string remitterAddress3Field;
        
            private string payerOtherInfo1Field;
        
            private string payerOtherInfo2Field;
        
            private string beneficiaryFirstNameField;
        
            private string beneficiaryMiddleNameField;
        
            private string beneficiaryLastName1Field;
        
            private string beneficiaryLastName2Field;
        
            private string beneficiaryNationalityField;
        
            private string beneficiaryMobileField;
        
            private string beneficiaryEmailIDField;
        
            private string beneficiaryAddress1Field;
        
            private string beneficiaryAddress2Field;
        
            private string beneficiaryAddress3Field;
        
            private string beneficiaryBankBICCodeField;
        
            private string beneficiaryIBANField;
        
            private string beneficiaryBranchNameField;
        
            private string beneficiaryIDField;
        
            private string benOtherInfo1Field;
        
            private string benOtherInfo2Field;
        
            private string transferPurposeField;
        
            private string chargeTypeField;
        
            private string optionalField1Field;
        
            private string optionalField2Field;
        
            private string optionalField3Field;
        
            private string optionalField4Field;
        
            private string optionalField5Field;
        
            private string optionalField6Field;
        
            private string optionalField7Field;
        
            private string optionalField8Field;
        
            private string optionalField9Field;
        
            private string optionalField10Field;
        
            /// <remarks/>
            public string recordType {
                get {
                    return this.recordTypeField;
                }
                set {
                    this.recordTypeField = value;
                }
            }
        
            /// <remarks/>
            public string transactionReference {
                get {
                    return this.transactionReferenceField;
                }
                set {
                    this.transactionReferenceField = value;
                }
            }
        
            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute(DataType="date")]
            public System.DateTime transactionDate {
                get {
                    return this.transactionDateField;
                }
                set {
                    this.transactionDateField = value;
                }
            }
        
            /// <remarks/>
            public string senderCurrency {
                get {
                    return this.senderCurrencyField;
                }
                set {
                    this.senderCurrencyField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryCurrency {
                get {
                    return this.beneficiaryCurrencyField;
                }
                set {
                    this.beneficiaryCurrencyField = value;
                }
            }
        
            /// <remarks/>
            public decimal transferAmount {
                get {
                    return this.transferAmountField;
                }
                set {
                    this.transferAmountField = value;
                }
            }
        
            /// <remarks/>
            public string remitterFirstName {
                get {
                    return this.remitterFirstNameField;
                }
                set {
                    this.remitterFirstNameField = value;
                }
            }
        
            /// <remarks/>
            public string remitterMiddleName {
                get {
                    return this.remitterMiddleNameField;
                }
                set {
                    this.remitterMiddleNameField = value;
                }
            }
        
            /// <remarks/>
            public string remitterLastName1 {
                get {
                    return this.remitterLastName1Field;
                }
                set {
                    this.remitterLastName1Field = value;
                }
            }
        
            /// <remarks/>
            public string remitterLastName2 {
                get {
                    return this.remitterLastName2Field;
                }
                set {
                    this.remitterLastName2Field = value;
                }
            }
        
            /// <remarks/>
            public string remitterNationality {
                get {
                    return this.remitterNationalityField;
                }
                set {
                    this.remitterNationalityField = value;
                }
            }
        
            /// <remarks/>
            public string remitterMobileNo {
                get {
                    return this.remitterMobileNoField;
                }
                set {
                    this.remitterMobileNoField = value;
                }
            }
        
            /// <remarks/>
            public string remitterAddress1 {
                get {
                    return this.remitterAddress1Field;
                }
                set {
                    this.remitterAddress1Field = value;
                }
            }
        
            /// <remarks/>
            public string remitterAddress2 {
                get {
                    return this.remitterAddress2Field;
                }
                set {
                    this.remitterAddress2Field = value;
                }
            }
        
            /// <remarks/>
            public string remitterAddress3 {
                get {
                    return this.remitterAddress3Field;
                }
                set {
                    this.remitterAddress3Field = value;
                }
            }
        
            /// <remarks/>
            public string payerOtherInfo1 {
                get {
                    return this.payerOtherInfo1Field;
                }
                set {
                    this.payerOtherInfo1Field = value;
                }
            }
        
            /// <remarks/>
            public string payerOtherInfo2 {
                get {
                    return this.payerOtherInfo2Field;
                }
                set {
                    this.payerOtherInfo2Field = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryFirstName {
                get {
                    return this.beneficiaryFirstNameField;
                }
                set {
                    this.beneficiaryFirstNameField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryMiddleName {
                get {
                    return this.beneficiaryMiddleNameField;
                }
                set {
                    this.beneficiaryMiddleNameField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryLastName1 {
                get {
                    return this.beneficiaryLastName1Field;
                }
                set {
                    this.beneficiaryLastName1Field = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryLastName2 {
                get {
                    return this.beneficiaryLastName2Field;
                }
                set {
                    this.beneficiaryLastName2Field = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryNationality {
                get {
                    return this.beneficiaryNationalityField;
                }
                set {
                    this.beneficiaryNationalityField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryMobile {
                get {
                    return this.beneficiaryMobileField;
                }
                set {
                    this.beneficiaryMobileField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryEmailID {
                get {
                    return this.beneficiaryEmailIDField;
                }
                set {
                    this.beneficiaryEmailIDField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryAddress1 {
                get {
                    return this.beneficiaryAddress1Field;
                }
                set {
                    this.beneficiaryAddress1Field = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryAddress2 {
                get {
                    return this.beneficiaryAddress2Field;
                }
                set {
                    this.beneficiaryAddress2Field = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryAddress3 {
                get {
                    return this.beneficiaryAddress3Field;
                }
                set {
                    this.beneficiaryAddress3Field = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryBankBICCode {
                get {
                    return this.beneficiaryBankBICCodeField;
                }
                set {
                    this.beneficiaryBankBICCodeField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryIBAN {
                get {
                    return this.beneficiaryIBANField;
                }
                set {
                    this.beneficiaryIBANField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryBranchName {
                get {
                    return this.beneficiaryBranchNameField;
                }
                set {
                    this.beneficiaryBranchNameField = value;
                }
            }
        
            /// <remarks/>
            public string beneficiaryID {
                get {
                    return this.beneficiaryIDField;
                }
                set {
                    this.beneficiaryIDField = value;
                }
            }
        
            /// <remarks/>
            public string benOtherInfo1 {
                get {
                    return this.benOtherInfo1Field;
                }
                set {
                    this.benOtherInfo1Field = value;
                }
            }
        
            /// <remarks/>
            public string benOtherInfo2 {
                get {
                    return this.benOtherInfo2Field;
                }
                set {
                    this.benOtherInfo2Field = value;
                }
            }
        
            /// <remarks/>
            public string transferPurpose {
                get {
                    return this.transferPurposeField;
                }
                set {
                    this.transferPurposeField = value;
                }
            }
        
            /// <remarks/>
            public string chargeType {
                get {
                    return this.chargeTypeField;
                }
                set {
                    this.chargeTypeField = value;
                }
            }
        
            /// <remarks/>
            public string optionalField1 {
                get {
                    return this.optionalField1Field;
                }
                set {
                    this.optionalField1Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField2 {
                get {
                    return this.optionalField2Field;
                }
                set {
                    this.optionalField2Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField3 {
                get {
                    return this.optionalField3Field;
                }
                set {
                    this.optionalField3Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField4 {
                get {
                    return this.optionalField4Field;
                }
                set {
                    this.optionalField4Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField5 {
                get {
                    return this.optionalField5Field;
                }
                set {
                    this.optionalField5Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField6 {
                get {
                    return this.optionalField6Field;
                }
                set {
                    this.optionalField6Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField7 {
                get {
                    return this.optionalField7Field;
                }
                set {
                    this.optionalField7Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField8 {
                get {
                    return this.optionalField8Field;
                }
                set {
                    this.optionalField8Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField9 {
                get {
                    return this.optionalField9Field;
                }
                set {
                    this.optionalField9Field = value;
                }
            }
        
            /// <remarks/>
            public string optionalField10 {
                get {
                    return this.optionalField10Field;
                }
                set {
                    this.optionalField10Field = value;
                }
            }
        }
        //------------------------------------------------------------------------------
        // <auto-generated>
        //     This code was generated by a tool.
        //     Runtime Version:2.0.50727.6421
        //
        //     Changes to this file may cause incorrect behavior and will be lost if
        //     the code is regenerated.
        // </auto-generated>
        //------------------------------------------------------------------------------
        //using System.Xml.Serialization;
        // 
        // This source code was auto-generated by xsd, Version=2.0.50727.3038.
        // 
        /// <remarks/>
        [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
        [System.SerializableAttribute()]
        [System.Diagnostics.DebuggerStepThroughAttribute()]
        [System.ComponentModel.DesignerCategoryAttribute("code")]
        [System.Xml.Serialization.XmlTypeAttribute(Namespace = "http://schemas.xmlsoap.org/soap/envelope/")]
        [System.Xml.Serialization.XmlRootAttribute(Namespace = "http://schemas.xmlsoap.org/soap/envelope/", IsNullable = false)]
        public partial class Envelope {
        
            private EnvelopeHeader[] headerField;
        
            private EnvelopeBody[] bodyField;
        
            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute("Header")]
            public EnvelopeHeader[] Header {
                get {
                    return this.headerField;
                }
                set {
                    this.headerField = value;
                }
            }
        
            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute("Body")]
            public EnvelopeBody[] Body {
                get {
                    return this.bodyField;
                }
                set {
                    this.bodyField = value;
                }
            }
        }
        /// <remarks/>
        [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
        [System.SerializableAttribute()]
        [System.Diagnostics.DebuggerStepThroughAttribute()]
        [System.ComponentModel.DesignerCategoryAttribute("code")]
        [System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true, Namespace = "http://schemas.xmlsoap.org/soap/envelope/")]
        public partial class EnvelopeHeader
        {
            // added manually
            [XmlElement(Namespace = "http://creation.soapws.progressoft.com/")]
            public string paymentOperation { get; set; }
            [XmlElement(Namespace = "http://creation.soapws.progressoft.com/")]
            public DateTime requestTimeStamp { get; set; }
            [XmlElement(Namespace = "http://creation.soapws.progressoft.com/")]
            public string securityToken { get; set; }
            [XmlElement(Namespace = "http://creation.soapws.progressoft.com/")]
            public string username { get; set; }
        }
        /// <remarks/>
        [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
        [System.SerializableAttribute()]
        [System.Diagnostics.DebuggerStepThroughAttribute()]
        [System.ComponentModel.DesignerCategoryAttribute("code")]
        [System.Xml.Serialization.XmlTypeAttribute(Namespace = "http://schemas.xmlsoap.org/soap/envelope/")]
        public partial class detail
        {
        }
        /// <remarks/>
        [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
        [System.SerializableAttribute()]
        [System.Diagnostics.DebuggerStepThroughAttribute()]
        [System.ComponentModel.DesignerCategoryAttribute("code")]
        [System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true, Namespace = "http://schemas.xmlsoap.org/soap/envelope/")]
        public partial class EnvelopeBody
        {
            //added manually
            [XmlElement(ElementName = "createPayment", Namespace = "http://creation.soapws.progressoft.com/" )]
            public paymentItem item { get; set; }
        }
        /// <remarks/>
        [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
        [System.SerializableAttribute()]
        [System.Diagnostics.DebuggerStepThroughAttribute()]
        [System.ComponentModel.DesignerCategoryAttribute("code")]
        [System.Xml.Serialization.XmlTypeAttribute(Namespace = "http://schemas.xmlsoap.org/soap/envelope/")]
        [System.Xml.Serialization.XmlRootAttribute(Namespace = "http://schemas.xmlsoap.org/soap/envelope/", IsNullable = false)]
        public partial class Fault
        {
            private System.Xml.XmlQualifiedName faultcodeField;
            private string faultstringField;
            private string faultactorField;
            private detail detailField;
            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified)]
            public System.Xml.XmlQualifiedName faultcode
            {
                get
                {
                    return this.faultcodeField;
                }
                set
                {
                    this.faultcodeField = value;
                }
            }
            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified)]
            public string faultstring
            {
                get
                {
                    return this.faultstringField;
                }
                set
                {
                    this.faultstringField = value;
                }
            }
            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified, DataType = "anyURI")]
            public string faultactor
            {
                get
                {
                    return this.faultactorField;
                }
                set
                {
                    this.faultactorField = value;
                }
            }
            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute(Form = System.Xml.Schema.XmlSchemaForm.Unqualified)]
            public detail detail
            {
                get
                {
                    return this.detailField;
                }
                set
                {
                    this.detailField = value;
                }
            }
        }
     
    }
