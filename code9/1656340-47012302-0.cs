    using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;
    using System.Xml;
    using System.Xml.Linq;
    namespace WindowsFormsApplication4
    {
        public partial class Form1 : Form
        {
            const string FILENAME = @"c:\temp\test.xml";
            public Form1()
            {
                InitializeComponent();
                DataTable dt = new DataTable();
                dt.Columns.Add("StartTime", typeof(DateTime));
                dt.Columns.Add("EndTime", typeof(DateTime));
                dt.Columns.Add("WorkShift", typeof(string));
                dt.Columns.Add("WorkShiftModel", typeof(string));
                dt.Columns.Add("UtilizationCategory", typeof(string));
                dt.Columns.Add("UtilizationCategoryDetail", typeof(string));
                dt.Columns.Add("Remarks", typeof(string));
                dt.Columns.Add("OperatorPerson", typeof(string));
                dt.Columns.Add("IsAutogenerated", typeof(Boolean));
                dt.Columns.Add("UsedEquipmentTypes", typeof(string));
                dt.Columns.Add("Name", typeof(string));
                dt.Columns.Add("Value", typeof(string));
                XDocument doc = XDocument.Load(FILENAME);
                foreach (XElement timeSlot in doc.Descendants("TimeSlot"))
                {
                    foreach (XElement nameValuePair in timeSlot.Descendants().Where(x => x.Name.LocalName == "NameValuePair"))
                    {
                        DataRow newRow = dt.Rows.Add();
                        XNamespace ns = nameValuePair.GetDefaultNamespace();
                        newRow["StartTime"] = (DateTime)timeSlot.Element(ns + "StartTime");
                        newRow["EndTime"] = (DateTime)timeSlot.Element(ns + "EndTime");
                        newRow["WorkShift"] = (string)timeSlot.Element(ns + "WorkShift");
                        newRow["WorkShiftModel"] = (string)timeSlot.Element(ns + "WorkShiftModel");
                        newRow["UtilizationCategory"] = (string)timeSlot.Element(ns + "UtilizationCategory");
                        newRow["UtilizationCategoryDetail"] = (string)timeSlot.Element(ns + "UtilizationCategoryDetail");
                        newRow["Remarks"] = (string)timeSlot.Element(ns + "Remarks");
                        newRow["OperatorPerson"] = (string)timeSlot.Element(ns + "OperatorPerson");
                        newRow["IsAutoGenerated"] = (Boolean)timeSlot.Element(ns + "IsAutoGenerated");
                        newRow["Name"] = (string)nameValuePair.Element(ns + "Name");
                        newRow["Value"] = (string)nameValuePair.Element(ns + "Value");
                    }
                }
                dataGridView1.DataSource = dt;
            }
        }
    }
